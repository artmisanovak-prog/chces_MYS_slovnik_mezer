<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üê± KOCOUR ‚Äì diagnostick√Ω m√≥d</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
        }
        body {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 20px;
            background: #fafaf8;
            color: #1e1e1e;
        }
        h1 {
            font-size: 2.2rem;
            font-weight: 400;
            border-bottom: 2px dashed #aaa;
            padding-bottom: 0.5rem;
            margin-top: 0;
        }
        h1::before {
            content: "üê± ";
            font-size: 2rem;
        }
        .container {
            display: flex;
            gap: 2rem;
            align-items: flex-start;
        }

        /* ===== LEV√ù PANEL ‚Äì TAH√ÅK 12 √öHL≈Æ ===== */
        .sidebar {
            flex: 0 0 300px;
            background: #f0ede9;
            padding: 1.5rem;
            border-radius: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.03);
            align-self: stretch;
        }
        .sidebar h2 {
            font-size: 1.4rem;
            font-weight: 500;
            margin-top: 0;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #ccc;
            padding-bottom: 0.5rem;
        }
        .angle-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .angle-item {
            margin-bottom: 1.4rem;
            border-left: 3px solid transparent;
            padding-left: 0.8rem;
            transition: 0.1s;
        }
        .angle-item:hover {
            border-left-color: #b8a9a9;
        }
        .angle-title {
            font-weight: 600;
            font-size: 1rem;
            display: block;
            margin-bottom: 0.2rem;
            color: #2c3e50;
        }
        .angle-desc {
            font-size: 0.85rem;
            color: #4a4a4a;
            line-height: 1.4;
            opacity: 0.85;
        }

        /* ===== PRAV√Å PRACOVN√ç PLOCHA ===== */
        .main {
            flex: 1;
            min-width: 0;
        }
        .toolbar {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
            align-items: center;
        }
        .btn {
            background: white;
            border: 1px solid #bbb;
            padding: 0.6rem 1.4rem;
            border-radius: 40px;
            font-size: 1rem;
            cursor: pointer;
            transition: 0.1s;
            box-shadow: 0 2px 3px rgba(0,0,0,0.02);
            font-weight: 450;
        }
        .btn:hover {
            background: #f0f0f0;
            border-color: #8a8a8a;
        }
        .btn-primary {
            background: #2c3e50;
            border-color: #1a2632;
            color: white;
        }
        .btn-primary:hover {
            background: #1f2d3a;
        }

        /* Blok jednoho ƒçlena */
        .member-card {
            background: white;
            border: 1px solid #e0ddd9;
            border-radius: 24px;
            padding: 1.5rem 1.8rem;
            margin-bottom: 1.8rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.02);
            transition: 0.1s;
        }
        .member-card.completed {
            opacity: 0.7;
            background: #f6f4f0;
        }
        .member-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        .member-name-wrapper {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .member-label {
            font-weight: 500;
            color: #4e4e4e;
        }
        .member-name-input {
            border: none;
            border-bottom: 1px dashed #aaa;
            background: transparent;
            padding: 0.3rem 0.5rem;
            font-size: 1rem;
            width: 200px;
            outline: none;
        }
        .member-name-input:focus {
            border-bottom-color: #2c3e50;
        }
        .member-actions {
            display: flex;
            gap: 0.8rem;
        }
        .mark-done, .delete-member {
            background: none;
            border: none;
            font-size: 1.3rem;
            cursor: pointer;
            padding: 0 5px;
            opacity: 0.5;
            transition: 0.1s;
        }
        .mark-done:hover, .delete-member:hover {
            opacity: 1;
        }
        .mark-done:hover { color: #2a7a2a; }
        .delete-member:hover { color: #b52b2b; }

        /* Jedna ot√°zka uvnit≈ô bloku */
        .question-block {
            margin-bottom: 1.5rem;
        }
        .question-text {
            font-weight: 600;
            margin-bottom: 0.3rem;
            color: #1f2d3a;
        }
        .answer-input {
            width: 100%;
            min-height: 80px;
            padding: 0.8rem;
            border: 1px solid #d4cfc8;
            border-radius: 16px;
            font-size: 0.95rem;
            resize: vertical;
            background: #ffffff;
        }
        .answer-input:focus {
            outline: none;
            border-color: #9e9e9e;
        }

        /* ===== V√ùSLEDKOV√Å OBLAST ===== */
        .results {
            margin-top: 3rem;
            padding-top: 1.5rem;
            border-top: 2px dashed #bbb;
        }
        .results h2 {
            font-weight: 400;
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
        }
        #results-chart {
            max-height: 350px;
            max-width: 600px;
            margin: 1rem 0 2rem 0;
        }
        .angle-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 2rem;
            margin: 2rem 0;
        }
        .stat-column {
            flex: 1 1 200px;
            background: #f6f4ef;
            padding: 1.2rem;
            border-radius: 24px;
        }
        .stat-column h3 {
            margin-top: 0;
            font-weight: 500;
            border-bottom: 1px solid #ccc;
            padding-bottom: 0.5rem;
        }
        .advice-list {
            margin: 1rem 0;
        }
        .advice-item {
            background: white;
            padding: 1rem 1.3rem;
            border-radius: 20px;
            margin-bottom: 0.8rem;
            border-left: 5px solid;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<h1>KOCOUR ‚Äì diagnostick√Ω m√≥d</h1>

<div class="container">
    <!-- LEV√ù PANEL ‚Äì 12 √öHL≈Æ (TAH√ÅK) -->
    <div class="sidebar">
        <h2>üìê 12 √∫hl≈Ø pohledu</h2>
        <ul class="angle-list" id="angle-list"></ul>
    </div>

    <!-- PRAV√Å PRACOVN√ç PLOCHA -->
    <div class="main">
        <div class="toolbar">
            <button class="btn" id="addMemberBtn">‚ûï P≈ôidat ƒçlena</button>
            <button class="btn btn-primary" id="evaluateBtn">üîç Vyhodnotit odpovƒõdi</button>
        </div>

        <!-- ZDE SE DYNAMICKY VKL√ÅDAJ√ç KARTY JEDNOTLIV√ùCH ƒåLEN≈Æ -->
        <div id="membersContainer"></div>
    </div>
</div>

<!-- V√ùSLEDKOV√Å OBLAST -->
<div class="results" id="resultsArea" style="display: none;">
    <h2>üß† Kognitivn√≠ mapa t√Ωmu</h2>
    <canvas id="resultsChart"></canvas>

    <div class="angle-stats" id="statsOverloaded"></div>

    <h3 style="margin-top:2rem;">üìå Rady (Q3) pro √∫hly v t√Ωmu</h3>
    <div id="adviceList" class="advice-list"></div>
</div>

<script>
    (function() {
        // =========================================================
        // 1. DATA ‚Äì 12 √öHL≈Æ (podle My≈° ‚Äì kl√≠ƒç k √∫hl≈Øm)
        // =========================================================
        const angles = [
            { num: 1, name: "Absurdn√≠", 
              desc: "Hled√° rozpor, paradox, m√≠sto kde svƒõt p≈ôestal d√°vat smysl. D≈Øraz na zhroucen√≠ pravidel." },
            { num: 2, name: "Jazykov√Ω", 
              desc: "Hra se slovy, rytmus, citace. Forma je obsah. Konkr√©tn√≠ formulace, h≈ô√≠ƒçky." },
            { num: 3, name: "Ironick√Ω", 
              desc: "Vid√≠ propast mezi z√°mƒõrem a v√Ωsledkem. Sarkasmus, odhalen√≠ pokrytectv√≠." },
            { num: 4, name: "Filozofick√Ω", 
              desc: "Hled√° univerz√°ln√≠ pravdu, smysl za smyslem. T√≠hne k podstatƒõ, ne dƒõji." },
            { num: 5, name: "Surrealistick√Ω", 
              desc: "Voln√© asociace, snov√° logika, bizarn√≠ spojen√≠. Obrazy bez vysvƒõtlen√≠." },
            { num: 6, name: "Naivn√≠", 
              desc: "Dƒõtsk√° logika, p≈ô√≠m√°, bez interpretace. Jednoduch√° emoce, ƒçist√Ω dojem." },
            { num: 7, name: "Intro (introspektivn√≠)", 
              desc: "Projekce vlastn√≠ho pro≈æitku. Osobn√≠ zku≈°enost, emoce, vzpom√≠nka." },
            { num: 8, name: "V≈°eobecn√Ω (konkr√©tn√≠)", 
              desc: "Dr≈æ√≠ se fakt≈Ø, dƒõj je dƒõj. Odpor k interpretaci, p≈ôesn√© konstatov√°n√≠." },
            { num: 9, name: "Analogick√Ω (kulturn√≠)", 
              desc: "Hled√° vzorce, archetypy. Odkaz na jin√© p≈ô√≠bƒõhy, m√Ωty, paralely." },
            { num: 10, name: "Asociaƒçn√≠", 
              desc: "Rychl√© spojen√≠, ≈ôetƒõz asociac√≠, odboƒçky, skokov√© my≈°len√≠." },
            { num: 11, name: "Metaforick√Ω (symbolick√Ω)", 
              desc: "V≈°e je symbolem. Hled√° skryt√Ω v√Ωznam, p≈ôev√°d√≠ obrazy do abstrakce." },
            { num: 12, name: "Groteskn√≠", 
              desc: "P≈ôehnan√©, karikuj√≠c√≠, ƒçern√Ω humor. Komiƒçno i v trag√©dii." }
        ];

        // =========================================================
        // 2. Rady Q3 pro Kocoura (dopl≈à vlastn√≠mi texty z karty)
        // =========================================================
        const q3Rad = [
            "Zav√©st pravidlo 't≈ô√≠ teƒçek' ‚Äì prvn√≠, kdo ≈ôekne teƒçka, jen shrnuje, neuzav√≠r√°.",
            "Mƒõ≈ôit √∫spƒõch sch≈Øze poƒçtem otev≈ôen√Ωch ot√°zek na konci.",
            "Vytvo≈ôit 'n√°stƒõnku nespolknut√©ho' pro nevy≈ôƒçen√° t√©mata.",
            "Jmenovat 'my≈°' ‚Äì pozorovatele, kter√Ω na konci sdƒõl√≠, kdo mluvil a kdo byl p≈ôeru≈°en.",
            "Leader vƒõdomƒõ tvo≈ô√≠ nedokonƒçen√© vƒõty a vyz√Ωv√° k dokonƒçen√≠.",
            "Ke ka≈æd√© metrice p≈ôidat kvalitativn√≠ p≈ô√≠bƒõh ‚Äì 'jak√Ωch 14 teƒçek jsme vykrkli'.",
            "Zav√©st 'souhlas ticha = nesouhlas' ‚Äì mlƒçen√≠ se pova≈æuje za nesouhlas.",
            "Pou≈æ√≠vat mluv√≠c√≠ p≈ôedmƒõt (talking stick). Mluv√≠ jen ten, kdo ho dr≈æ√≠.",
            "Cviƒçen√≠ '√∫myslnƒõ nedokonƒçovat' ‚Äì zad√°vat jen zaƒç√°tky metafor.",
            "Prov√©st audit komunikaƒçn√≠ bezpeƒçnosti (anonymn√≠ dotazn√≠k).",
            "P≈ôi uzav√≠r√°n√≠ se pt√°t: 'Kdo c√≠t√≠, ≈æe jeho hlas nebyl sly≈°en?'",
            "Zav√©st beru≈°ƒç√≠ ritu√°l ‚Äì tich√Ω sign√°l pro zpomalen√≠ a vyslechnut√≠."
        ];

        // =========================================================
        // 3. Dynamick√© p≈ôid√°v√°n√≠ ƒçlen≈Ø a ukl√°d√°n√≠ odpovƒõd√≠
        // =========================================================
        let memberCount = 0;
        const membersContainer = document.getElementById('membersContainer');

        function createMemberCard(index) {
            const card = document.createElement('div');
            card.className = 'member-card';
            card.dataset.index = index;

            // Hlaviƒçka ‚Äì jm√©no, tlaƒç√≠tka
            const header = document.createElement('div');
            header.className = 'member-header';
            header.innerHTML = `
                <div class="member-name-wrapper">
                    <span class="member-label">ƒålen ${index + 1}</span>
                    <input type="text" class="member-name-input" placeholder="nepovinn√© jm√©no" data-index="${index}">
                </div>
                <div class="member-actions">
                    <span class="mark-done" data-index="${index}" title="oznaƒçit jako hotov√©">‚úì</span>
                    <span class="delete-member" data-index="${index}" title="odebrat">üóë</span>
                </div>
            `;
            card.appendChild(header);

            // 3 ot√°zky (texty podle Kocoura)
            const questions = [
                "Co je podle v√°s hlavn√≠ pointa nebo sdƒõlen√≠ tohoto p≈ô√≠bƒõhu?",
                "Kter√° konkr√©tn√≠ vƒõta, obraz nebo moment v√°s nejv√≠c zaujal/a a PROƒå?",
                "Kdyby tento p≈ô√≠bƒõh byl n√°vodem, co by v√°m radil dƒõlat/ne dƒõlat?"
            ];

            for (let qIdx = 0; qIdx < 3; qIdx++) {
                const qDiv = document.createElement('div');
                qDiv.className = 'question-block';
                qDiv.innerHTML = `
                    <div class="question-text">${questions[qIdx]}</div>
                    <textarea class="answer-input" data-member="${index}" data-question="${qIdx}" placeholder="odpovƒõƒè..."></textarea>
                `;
                card.appendChild(qDiv);
            }

            // Tlaƒç√≠tko pro smaz√°n√≠
            card.querySelector('.delete-member').addEventListener('click', (e) => {
                e.stopPropagation();
                card.remove();
            });

            // Tlaƒç√≠tko pro oznaƒçen√≠ hotovo
            card.querySelector('.mark-done').addEventListener('click', (e) => {
                e.stopPropagation();
                card.classList.toggle('completed');
            });

            return card;
        }

        document.getElementById('addMemberBtn').addEventListener('click', () => {
            const card = createMemberCard(memberCount);
            membersContainer.appendChild(card);
            memberCount++;
        });

        // =========================================================
        // 4. VYKRESLEN√ç LEV√âHO PANELU
        // =========================================================
        const angleListEl = document.getElementById('angle-list');
        angles.forEach(angle => {
            const li = document.createElement('li');
            li.className = 'angle-item';
            li.innerHTML = `<span class="angle-title">${angle.num}. ${angle.name}</span><span class="angle-desc">${angle.desc}</span>`;
            angleListEl.appendChild(li);
        });

        // =========================================================
        // 5. VYHODNOCEN√ç ‚Äì hlavn√≠ funkce
        // =========================================================
        document.getElementById('evaluateBtn').addEventListener('click', () => {
            const cards = document.querySelectorAll('.member-card');
            if (cards.length === 0) {
                alert('Nejprve p≈ôidejte alespo≈à jednoho ƒçlena t√Ωmu.');
                return;
            }

            // pro ka≈ædou odpovƒõƒè zjist√≠me, jak√Ω √∫hel facilit√°tor zvol√≠ (select)
            // teƒè vytvo≈ô√≠me select boxy pro ka≈ædou odpovƒõƒè (budou vidƒõt a≈æ teƒè)
            cards.forEach(card => {
                // pokud u≈æ existuj√≠ selecty, nesm√≠me je zdvojit ‚Äì jednoduch√° kontrola
                if (!card.querySelector('.angle-select')) {
                    const answers = card.querySelectorAll('.question-block');
                    answers.forEach(ans => {
                        const sel = document.createElement('select');
                        sel.className = 'angle-select';
                        sel.style.marginTop = '8px';
                        sel.style.padding = '5px';
                        sel.style.width = '100%';
                        sel.style.borderRadius = '30px';
                        sel.style.border = '1px solid #ccc';
                        // z√°kladn√≠ pr√°zdn√° mo≈ænost
                        const blankOpt = document.createElement('option');
                        blankOpt.value = '';
                        blankOpt.textContent = '-- vyberte √∫hel --';
                        sel.appendChild(blankOpt);
                        // naplnƒõn√≠ √∫hly
                        angles.forEach((a, idx) => {
                            const opt = document.createElement('option');
                            opt.value = idx; // ukl√°d√°me index 0‚Äì11
                            opt.textContent = `${a.num}. ${a.name}`;
                            sel.appendChild(opt);
                        });
                        ans.appendChild(sel);
                    });
                }
            });

            // nyn√≠ sesb√≠r√°me v≈°echny vybran√© √∫hly
            const allSelections = [];
            cards.forEach(card => {
                const selects = card.querySelectorAll('.angle-select');
                selects.forEach(sel => {
                    const val = sel.value;
                    if (val !== '') allSelections.push(parseInt(val));
                });
            });

            if (allSelections.length === 0) {
                alert('Ne≈æ vyhodnot√≠te, vyberte alespo≈à u nƒõkter√© odpovƒõdi √∫hel.');
                return;
            }

            // poƒç√≠t√°n√≠ ƒçetnost√≠ (12 √∫hl≈Ø)
            const counts = new Array(12).fill(0);
            allSelections.forEach(idx => counts[idx]++);

            // v√Ωpoƒçet procent
            const total = allSelections.length;
            const percentages = counts.map(c => (c / total * 100).toFixed(1));

            // sestaven√≠ seznam≈Ø pro p≈ôet√≠≈æen√©, deficitn√≠, vyv√°≈æen√©
            const overload = [], deficient = [], balanced = [];
            counts.forEach((c, i) => {
                if (c >= total * 0.3) overload.push(i);      // >30 % = p≈ôet√≠≈æen√Ω (prah lze upravit)
                else if (c === 0) deficient.push(i);
                else balanced.push(i);
            });

            // zobrazen√≠ v√Ωsledkov√© oblasti
            const resultsArea = document.getElementById('resultsArea');
            resultsArea.style.display = 'block';

            // kol√°ƒçov√Ω graf ‚Äì jen √∫hly kter√© maj√≠ nenulov√© %
            const chartLabels = [];
            const chartData = [];
            const chartColors = [];
            angles.forEach((a, i) => {
                if (counts[i] > 0) {
                    chartLabels.push(`${a.num}. ${a.name}`);
                    chartData.push(counts[i]);
                    chartColors.push(`hsl(${i * 30}, 70%, 65%)`);
                }
            });

            // vykreslen√≠ grafu (Chart.js)
            const ctx = document.getElementById('resultsChart').getContext('2d');
            if (window.myChart instanceof Chart) window.myChart.destroy();
            window.myChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: chartColors,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'right' },
                        tooltip: { callbacks: { label: (ctx) => `${ctx.raw} odpovƒõd√≠ (${((ctx.raw/total)*100).toFixed(1)}%)` } }
                    }
                }
            });

            // textov√© statistiky (p≈ôet√≠≈æen√© / deficitn√≠ / vyv√°≈æen√©)
            const statsDiv = document.getElementById('statsOverloaded');
            statsDiv.innerHTML = '';

            if (overload.length) {
                const col = document.createElement('div'); col.className = 'stat-column';
                col.innerHTML = `<h3>üî¥ P≈ôet√≠≈æen√© (>30%)</h3>`;
                overload.forEach(i => col.innerHTML += `<div><b>${angles[i].num}. ${angles[i].name}</b><br>${counts[i]}√ó (${percentages[i]}%)</div>`);
                statsDiv.appendChild(col);
            }
            if (deficient.length) {
                const col = document.createElement('div'); col.className = 'stat-column';
                col.innerHTML = `<h3>üü¢ Deficitn√≠ (0√ó)</h3>`;
                deficient.forEach(i => col.innerHTML += `<div><b>${angles[i].num}. ${angles[i].name}</b><br>chyb√≠</div>`);
                statsDiv.appendChild(col);
            }
            if (balanced.length) {
                const col = document.createElement('div'); col.className = 'stat-column';
                col.innerHTML = `<h3>‚öñÔ∏è Vyv√°≈æen√©</h3>`;
                balanced.forEach(i => col.innerHTML += `<div><b>${angles[i].num}. ${angles[i].name}</b><br>${counts[i]}√ó (${percentages[i]}%)</div>`);
                statsDiv.appendChild(col);
            }

            // rady Q3 pro √∫hly kter√© se v t√Ωmu objevily
            const adviceDiv = document.getElementById('adviceList');
            adviceDiv.innerHTML = '';
            for (let i=0; i<12; i++) {
                if (counts[i] > 0) {
                    const item = document.createElement('div');
                    item.className = 'advice-item';
                    item.style.borderLeftColor = `hsl(${i*30}, 70%, 65%)`;
                    item.innerHTML = `<b>${angles[i].num}. ${angles[i].name}</b><br>${q3Rad[i]}`;
                    adviceDiv.appendChild(item);
                }
            }
        });
    })();
</script>
</body>
</html>
